<div class="container-fluid mt-4">
  <div class="row"   *ngIf="!isProfilPage() && !isAnnonceuserPage()  && !isFavorisPage()
   && !isMesMessagesPage() && !isAjouterAnnoncePage() && !isStatistiqueuserPage()
   && !isContactsPage()">


    

    <!-- Sidebar -->
    <div class="col-md-3">
      <div class="list-group shadow-sm rounded-3">
        <a class="list-group-item list-group-item-action active">
          <i class="fas fa-tachometer-alt me-2"></i> Mon Dashboard
        </a>
        
        
        <a class="list-group-item list-group-item-action"  routerLink="/dashboard-client/profil"><i class="fas fa-user me-2"></i> Mon Profil</a>
        <a class="list-group-item list-group-item-action"  routerLink="/dashboard-client/annonceuser" ><i class="fas fa-building me-2"></i> Mes Annonces</a>
        <a class="list-group-item list-group-item-action"  routerLink="/dashboard-client//favoris"><i class="fas fa-heart me-2"></i> Mes Favoris</a>
        <a class="list-group-item list-group-item-action" routerLink="/dashboard-client/mes-messages"><i class="fas fa-envelope me-2"></i> Mes Messages</a>
     <a class="list-group-item list-group-item-action" routerLink="/dashboard-client/ajouter-annonce"><i class="fas fa-plus-circle me-2"></i> Publier un nouveau bien immobilier </a>
     <a class="list-group-item list-group-item-action" routerLink="/dashboard-client/statistiqueuser"><i class="fas fa-chart-bar me-2"></i> Statistiques de mes annonces</a>
<a class="list-group-item list-group-item-action" routerLink="/dashboard-client/contacts"><i class="fas fa-users me-2"></i> Contacts</a>

      </div>
    </div>


    

    <!-- Main -->
<div class="col-md-9">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold text-primary mb-0">Bienvenue, {{ userName }}</h3>

    <!-- Dropdown Mon Compte -->
    <ul class="navbar-nav d-flex align-items-center mb-0">
      <li class="nav-item dropdown">
        <a class="nav-link d-flex align-items-center" (click)="toggleDropdown()" style="cursor:pointer; position: relative;">
          <!-- Avatar utilisateur -->
          <img src="https://www.portraitprofessionnel.fr/wp-content/uploads/2022/02/Photographe_profesionnel_portrait_studio_a_Paris-1.jpg" 
               alt="Avatar utilisateur" class="rounded-circle avatar mr-2" />
          <!-- Nom utilisateur -->
          <span class="user-name">{{ userName }}</span>
          <!-- Badge notification -->
          <span class="flesh-badge"></span>
          <!-- Flèche animée -->
          <i class="fas fa-chevron-down ml-1" [ngClass]="{'fa-rotate-180': isDropdownOpen}"></i>
        </a>

        <!-- Dropdown menu -->
        <div class="dropdown-menu dropdown-menu-right shadow-sm" [class.show]="isDropdownOpen">
         
    
          <a class="dropdown-item text-danger" routerLink="/dashboard/logout">
            <i class="fas fa-sign-out-alt mr-2"></i> Déconnexion
          </a>
        </div>
      </li>
    </ul>
  </div>



 

     <!-- Stat cards améliorées -->
<div class="row g-4">
  <div class="col-md-3">
    <div class="card text-center shadow-lg p-3 border-0 rounded-3 hover-scale" style="background: linear-gradient(135deg,#6a11cb,#2575fc); color:#fff;">
      <i class="fas fa-building fa-2x mb-2"></i>
      <h5 class="fw-bold">{{ totalProperties }}</h5>
      <p class="small">Annonces publiées</p>
      <div class="progress rounded-pill" style="height: 6px;">
        <div class="progress-bar bg-light" role="progressbar" style="width: 70%"></div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-center shadow-lg p-3 border-0 rounded-3 hover-scale" style="background: linear-gradient(135deg,#ff416c,#ff4b2b); color:#fff;">
      <i class="fas fa-heart fa-2x mb-2"></i>
      <h5 class="fw-bold">{{ totalFavorites }}</h5>
      <p class="small">Favoris</p>
      <div class="progress rounded-pill" style="height: 6px;">
        <div class="progress-bar bg-light" role="progressbar" style="width: 50%"></div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-center shadow-lg p-3 border-0 rounded-3 hover-scale" style="background: linear-gradient(135deg,#00b09b,#96c93d); color:#fff;">
      <i class="fas fa-envelope fa-2x mb-2"></i>
      <h5 class="fw-bold">{{ totalMessages }}</h5>
      <p class="small">Messages</p>
      <div class="progress rounded-pill" style="height: 6px;">
        <div class="progress-bar bg-light" role="progressbar" style="width: 85%"></div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="card text-center shadow-lg p-3 border-0 rounded-3 hover-scale" style="background: linear-gradient(135deg,#f7971e,#ffd200); color:#fff;">
      <i class="fas fa-eye fa-2x mb-2"></i>
      <h5 class="fw-bold">{{ totalVisits }}</h5>
      <p class="small">Visites</p>
      <div class="progress rounded-pill" style="height: 6px;">
        <div class="progress-bar bg-light" role="progressbar" style="width: 60%"></div>
      </div>
    </div>
  </div>
</div>


      <!-- Charts -->
      <div class="row mt-4 g-4">
        <div class="col-md-6">
          <div class="card shadow-sm p-3">
            <h5 class="fw-bold"><i class="fas fa-chart-line me-2 text-primary"></i> Annonces</h5>
            <canvas id="propertiesChart"></canvas>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card shadow-sm p-3">
            <h5 class="fw-bold"><i class="fas fa-eye me-2 text-success"></i> Visites</h5>
            <canvas id="visitsChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Table des annonces -->
      <div class="row mt-4">
        <div class="col-md-12">
          <div class="card shadow-sm">
            <div class="card-header"><i class="fas fa-bullhorn me-2"></i> Annonces récentes</div>
            <div class="card-body p-2">
              <table class="table table-sm">
                <thead>
                  <tr><th>Titre</th><th>Ville</th><th>Statut</th></tr>
                </thead>
                <tbody>
                  <tr *ngFor="let prop of properties">
                    <td>{{prop.title}}</td>
                    <td>{{prop.city}}</td>
                    <td>
                      <span class="badge" [ngClass]="{
                        'badge-primary': prop.status==='Publiée',
                        'badge-warning text-dark': prop.status==='Brouillon'
                      }">{{prop.status}}</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- Table messages -->
      <div class="row mt-4">
        <div class="col-md-12">
          <div class="card shadow-sm">
            <div class="card-header"><i class="fas fa-envelope me-2"></i> Messages récents</div>
            <div class="card-body p-2">
              <table class="table table-sm">
                <thead>
                  <tr><th>De</th><th>Sujet</th><th>Date</th></tr>
                </thead>
                <tbody>
                  <tr *ngFor="let msg of messages">
                    <td>{{msg.from}}</td>
                    <td>{{msg.subject}}</td>
                    <td>{{msg.date}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
 <router-outlet></router-outlet>
