<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light shadow-sm px-4">
  <a class="navbar-brand font-weight-bold d-flex align-items-center" routerLink="#">
    <i class="fas fa-home text-primary mr-2"></i> ImmoSmart
  </a>

  <!-- Barre de recherche -->
  <form class="form-inline mx-auto w-50">
    <input class="form-control search-input w-100" type="search" placeholder="Rechercher..." aria-label="Recherche" />
  </form>

  <!-- Avatar utilisateur -->
 <ul class="navbar-nav">
  <li class="nav-item dropdown">
    <a class="nav-link d-flex align-items-center" (click)="toggleDropdown()" style="cursor:pointer; position: relative;">
      <img src="https://www.portraitprofessionnel.fr/wp-content/uploads/2022/02/Photographe_profesionnel_portrait_studio_a_Paris-1.jpg" 
           alt="Avatar utilisateur" class="rounded-circle avatar mr-2" />
      <span class="user-name">Islem</span>
      
      <!-- Fleche animÃ©e / â€œfleshâ€ -->
      <span class="flesh-badge"></span>
      
      <i class="fas fa-chevron-down ml-1" [ngClass]="{'fa-rotate-180': isDropdownOpen}"></i>
    </a>
    <div class="dropdown-menu dropdown-menu-right shadow-sm" [class.show]="isDropdownOpen">
       <a class="dropdown-item" routerLink="/dashboard/profile"><i class="fas fa-user mr-2"></i> Profil</a>
        <a class="dropdown-item" routerLink="/dashboard/settings"><i class="fas fa-cog mr-2"></i> ParamÃ¨tres</a>  
            <div class="dropdown-divider"></div>
        <a class="dropdown-item text-danger" routerLink="/dashboard/logout"><i class="fas fa-sign-out-alt mr-2"></i> DÃ©connexion</a>   
 </div>
  </li>
</ul>

</nav>


<div class="container-fluid">
  <div class="row"
   *ngIf="!isUsersPage() && !isStatistiquesPage()
     && !isAnnoncesPage()  && !isValiderAnnoncesPage() && !isStatistiquesAnnoncesPage()  
      && !isStatistiquesDashboardPage() && !isRolesAccessPage()  && !isMessagesPage()
      && !isJournalMenuPage()  && !isProfilePage()  && !isSettingsPage()  && !isLogoutPage() 
      && !isChangerPhotoPage() && !isChangePasswordPage() ">

    <!-- Sidebar -->
    <nav class="col-lg-2 col-md-3 sidebar bg-light vh-100 p-3">
      <h4 class="mb-4"><i class="fas fa-home"></i> ImmoSmart</h4>
      <ul class="nav flex-column">

        <!-- Dashboard -->
        <li class="nav-item">
          <a routerLink="/dashboard" class="nav-link"><i class="fas fa-tachometer-alt"></i> Dashboard-admin</a>
        </li>

        <!-- Utilisateurs -->
        <li class="nav-item">
          <a class="nav-link d-flex justify-content-between align-items-center" (click)="toggleMenu('users')">
            <span><i class="fas fa-users"></i> Utilisateurs</span>
            <i class="fas" [ngClass]="{'fa-chevron-down': !menus.users, 'fa-chevron-up': menus.users}"></i>
          </a>
          <ul class="list-unstyled pl-3" *ngIf="menus.users">
            <li>
              <a routerLink="/dashboard/users" class="nav-link">ğŸ‘¥ Liste des utilisateurs</a>
            </li>
            
            <li>      
              <a routerLink="/dashboard/statistiques" class="nav-link">ğŸ“Š Statistiques des utilisateurs</a>
             </li>         
           </ul>
        </li>
   

        


        <!-- Annonces -->
        <li class="nav-item">
          <a class="nav-link d-flex justify-content-between align-items-center" (click)="toggleMenu('properties')">
            <span><i class="fas fa-bullhorn"></i> Annonces</span>
            <i class="fas" [ngClass]="{'fa-chevron-down': !menus.properties, 'fa-chevron-up': menus.properties}"></i>
          </a>
          <ul class="list-unstyled pl-3" *ngIf="menus.properties" >
            <li><a routerLink="/dashboard/annonces" class="nav-link">ğŸ˜ï¸ Liste des annonces</a></li>
            <li ><a routerLink="/dashboard/valider-annonces" class="nav-link">âœ… Valider / Refuser</a></li>
            <li><a routerLink="/dashboard/statistiques-annonces" class="nav-link">ğŸ“Š Statistiques des annonces</a></li>
          </ul>
        </li>

      


        <!-- Statistiques -->
        <li class="nav-item">
          <a class="nav-link d-flex justify-content-between align-items-center" (click)="toggleMenu('stats')">
            <span><i class="fas fa-chart-bar"></i> Statistiques</span>
            <i class="fas" [ngClass]="{'fa-chevron-down': !menus.stats, 'fa-chevron-up': menus.stats}"></i>
          </a>
          <ul class="list-unstyled pl-3" *ngIf="menus.stats">
            <li><a routerLink="/dashboard/statistiques-dashboard" class="nav-link">ğŸ“Š Tableau de bord</a></li>
       
          </ul>
        </li>

        <!-- RÃ´les & AccÃ¨s -->
        <li class="nav-item">
          <a class="nav-link d-flex justify-content-between align-items-center" (click)="toggleMenu('roles')">
            <span><i class="fas fa-user-shield"></i> RÃ´les & AccÃ¨s</span>
            <i class="fas" [ngClass]="{'fa-chevron-down': !menus.roles, 'fa-chevron-up': menus.roles}"></i>
          </a>
          <ul class="list-unstyled pl-3" *ngIf="menus.roles">
            <li><a routerLink="/dashboard/roles-access" class="nav-link">ğŸ” Affecter des rÃ´les</a></li>
          
          </ul>
        </li>

        <!-- Messages -->
        <li class="nav-item">
          <a class="nav-link d-flex justify-content-between align-items-center" (click)="toggleMenu('messages')">
            <span><i class="fas fa-envelope"></i> Messages</span>
            <i class="fas" [ngClass]="{'fa-chevron-down': !menus.messages, 'fa-chevron-up': menus.messages}"></i>
          </a>
          <ul class="list-unstyled pl-3" *ngIf="menus.messages">
            <li><a routerLink="/dashboard/messages" class="nav-link">ğŸ”” Alertes </a></li>
            
          </ul>
        </li>

       

        <!-- Journal dâ€™activitÃ© -->
        <li class="nav-item">
          <a class="nav-link d-flex justify-content-between align-items-center" (click)="toggleMenu('journal')">
            <span><i class="fas fa-history"></i> Journal</span>
            <i class="fas" [ngClass]="{'fa-chevron-down': !menus.journal, 'fa-chevron-up': menus.journal}"></i>
          </a>
          <ul class="list-unstyled pl-3" *ngIf="menus.journal">
            <li><a routerLink="/dashboard/journal-menu" class="nav-link"> ğŸ“‹ ActivitÃ©</a></li>
  
          </ul>
        </li>

      </ul>
    </nav>
    

    <!-- Main -->
<main class="col-lg-10 col-md-9 p-4">
  



      <!-- Statistiques principales -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="card-stat bg-primary">
            <h5><i class="fas fa-users"></i> {{usersCount}}</h5>
            <p>ğŸ‘¤ Utilisateurs inscrits</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card-stat bg-info">
            <h5><i class="fas fa-home"></i> {{propertiesCount}}</h5>
            <p>ğŸ  Annonces actives</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card-stat bg-danger">
            <h5><i class="fas fa-exclamation-circle"></i> {{reportsCount}}</h5>
            <p>ğŸš¨ Contenus signalÃ©s</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card-stat bg-warning text-dark">
            <h5><i class="fas fa-map-marker-alt"></i> {{citiesCount}}</h5>
            <p>ğŸŒ Villes couvertes</p>
          </div>
        </div>
      </div>

      <!-- Tables utilisateurs et annonces -->
      <div class="row">

        <!-- Derniers utilisateurs -->
        <div class="col-md-6 mb-4">
          <div class="card shadow-sm">
            <div class="card-header">
              <i class="fas fa-users-cog mr-2"></i> ğŸ“‹ Derniers utilisateurs
            </div>
            <div class="card-body p-2">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>RÃ´le</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let user of users">
                    <td>{{user.name}}</td>
                    <td>{{user.role}}</td>
                    <td>
                      <span class="badge" [ngClass]="{
                        'badge-success': user.status==='Actif',
                        'badge-secondary': user.status==='Inactif'
                      }">
                        {{user.status}}
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Annonces rÃ©centes -->
        <div class="col-md-6 mb-4">
          <div class="card shadow-sm">
            <div class="card-header">
              <i class="fas fa-bullhorn mr-2"></i> ğŸ“ Annonces rÃ©centes
            </div>
            <div class="card-body p-2">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th>Titre</th>
                    <th>Ville</th>
                    <th>Statut</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let prop of properties">
                    <td>{{prop.title}}</td>
                    <td>{{prop.city}}</td>
                    <td>
                      <span class="badge" [ngClass]="{
                        'badge-primary': prop.status==='PubliÃ©e',
                        'badge-warning text-dark': prop.status==='Brouillon',
                        'badge-danger': prop.status==='RefusÃ©e',
                        'badge-info': prop.status==='AcceptÃ©e'
                      }">
                        {{prop.status}}
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

      </div>

      <!-- Bas de page cards -->
     <div class="row">

  <!-- Ã‰volution des inscriptions utilisateurs -->
  <div class="col-md-4">
    <div class="card mb-3 shadow-sm">
      <div class="card-header">
        <i class="fas fa-chart-line mr-2"></i> Ã‰volution des inscriptions
      </div>
      <div class="card-body">
        <p>Inscriptions par mois</p>
        <canvas id="inscriptionsChart"></canvas>
      </div>
    </div>
  </div>

  <!-- PropriÃ©tÃ©s par type -->
  <div class="col-md-4">
    <div class="card mb-3 shadow-sm">
      <div class="card-header">
        <i class="fas fa-building mr-2"></i> PropriÃ©tÃ©s par type
      </div>
      <div class="card-body">
        <p>Maisons, Appartements, Villas</p>
        <canvas id="propertiesChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Revenus / Visites par mois -->
<div class="col-md-4">
  <div class="card mb-3 shadow-sm">
    <div class="card-header">
      <i class="fas fa-chart-area mr-2"></i> Revenus / Visites par mois
    </div>
    <div class="card-body">
      <p>Suivi des performances mensuelles</p>
      <canvas id="monthlyStatsChart"></canvas>
    </div>
  </div>
</div>


  <!-- Statut des utilisateurs -->
  <div class="col-md-4">
    <div class="card mb-3 shadow-sm">
      <div class="card-header">
        <i class="fas fa-users mr-2"></i> Statut des utilisateurs
      </div>
      <div class="card-body text-center">
        <canvas id="usersStatusChart"></canvas>
      </div>
    </div>
  </div>




   





        <!-- Colonne vide ou future -->
       <div class="col-md-4">
  <div class="card shadow-sm h-100">
    <div class="card-header d-flex align-items-center justify-content-between">
      <div>
        <i class="fas fa-info-circle mr-2"></i> Infos supplÃ©mentaires
      </div>
      <span class="badge bg-primary"></span>
    </div>
    <div class="card-body">
      <!-- Statistiques rapides -->
      <ul class="list-group list-group-flush mb-3">
        <li class="list-group-item d-flex justify-content-between align-items-center">
          PropriÃ©tÃ©s en attente
          <span class="badge bg-warning text-dark">5</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
          Messages non lus
          <span class="badge bg-info text-dark">12</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center">
          Signalements rÃ©cents
          <span class="badge bg-danger">3</span>
        </li>
      </ul>

      <!-- Actions rapides -->
      <div class="d-flex flex-column">
        <button class="btn btn-sm btn-primary mb-2">
          <i class="fas fa-plus mr-1"></i> Ajouter un utilisateur
        </button>
        <button class="btn btn-sm btn-secondary mb-2">
          <i class="fas fa-envelope mr-1"></i> Envoyer un message global
        </button>
        <button class="btn btn-sm btn-warning">
          <i class="fas fa-cog mr-1"></i> ParamÃ¨tres rapides
        </button>
      </div>
    </div>
  </div>
</div>


      </div> <!-- fin row bas de page -->
  

    </main> <!-- fin main -->
 
  </div> <!-- fin row principal -->
 

  </div> <!-- fin container-fluid -->
    <!-- Contenu dynamique -->
      <router-outlet></router-outlet>
    